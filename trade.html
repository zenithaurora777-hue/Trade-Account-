<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trade Room</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
:root{
--bg-light:#f4f6f9; --bg-dark:#0b0b0d;
--card-light:#fff; --card-dark:#111114;
--text-light:#111; --text-dark:#f2f2f2;
--muted:#9b9b9b; --line:#1f1f25;
--binance:#f0b90b; --danger:#ff3b3b; --success:#00c389;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,Segoe UI,Roboto;}
body{background:var(--bg-light);color:var(--text-light);padding-bottom:100px;transition:.35s;}
body.dark{background:var(--bg-dark);color:var(--text-dark);}
.topbar{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);padding:14px;display:flex;justify-content:space-between;align-items:center;}
body.dark .topbar{background:#0f0f12;}
.brand{display:flex;gap:10px;align-items:center;font-weight:700;}
.brand img{width:38px;height:38px;border-radius:12px;border:1px solid var(--line);}
.wrap{padding:14px;max-width:900px;margin:auto;display:grid;gap:14px;}
.card{background:var(--card-light);border:1px solid var(--line);border-radius:20px;padding:14px;}
body.dark .card{background:var(--card-dark);}
.btn{width:100%;padding:12px;border-radius:14px;border:none;font-weight:900;margin-top:10px;cursor:pointer;}
.btn.start{background:#f0b90b;color:#000;}
.btn.cancel{background:#ff3b3b;color:#fff;}
#holdBtn{background:#38bdf8;color:#fff;}
.balanceBox{font-size:30px;font-weight:900;margin-top:10px;}
#profit{font-size:22px;font-weight:900;margin-top:10px;transition:.2s;}
.up{color:#00c853;animation:flash .5s;}
.down{color:#ff3d00;animation:flash .5s;}
@keyframes flash{0%{opacity:.2}100%{opacity:1}}

canvas{width:100%;height:340px;background:#0b0f14;border-radius:14px;margin-top:10px;}

select{
width:100%;padding:10px;border-radius:10px;margin-top:10px;
border:1px solid var(--line);
}
</style>
</head>
<body>

<script>if(!localStorage.getItem("loggedin")) location.href="index.html";</script>

<header class="topbar">
<div class="brand">
<img src="logo.png">
<div>Trade Room<br><small id="livePair">BTC/USDT</small></div>
</div>
<div style="font-weight:bold;color:#f0b90b;">
$<span id="totalBalance">500.00</span>
</div>
</header>

<main class="wrap">

<section class="card">
<h3>Live Crypto Signal</h3>

<select id="pairSelect" onchange="changePair()">
<option>BTC/USDT</option>
<option>ETH/USDT</option>
<option>SOL/USDT</option>
<option>BNB/USDT</option>
<option>XRP/USDT</option>
<option>ADA/USDT</option>
<option>DOGE/USDT</option>
<option>AVAX/USDT</option>
<option>TRX/USDT</option>
<option>DOT/USDT</option>
</select>

<canvas id="chart"></canvas>
</section>

<section class="card">
<h3>AI Trade</h3>

<button class="btn start" id="tradeBtn" onclick="toggleTrade()">Start Trade</button>
<button class="btn" id="holdBtn" onclick="toggleHold()">Hold Trade</button>

<div id="profit">+$0.00</div>
<div id="liveBalance" class="balanceBox">Balance: $500.00</div>
</section>
</main>

<script>

/* ===============================
   SLOW MOVING PROFESSIONAL CHART
================================= */

const canvas=document.getElementById("chart");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth-40;
canvas.height=340;

let candles=[];
let basePrice=40000;
let offset=0;

function generateCandle(prev){
let volatility=120;
let open=prev;
let close=open+(Math.random()-0.5)*volatility;
let high=Math.max(open,close)+Math.random()*80;
let low=Math.min(open,close)-Math.random()*80;
return{open,close,high,low};
}

function initChart(){
candles=[];
let price=basePrice;
for(let i=0;i<80;i++){
let c=generateCandle(price);
candles.push(c);
price=c.close;
}
}

function drawChart(){
ctx.clearRect(0,0,canvas.width,canvas.height);

let x=-offset;
let candleWidth=8;
let gap=6;
let scale=0.015;

candles.forEach(c=>{
let openY=canvas.height-c.open*scale;
let closeY=canvas.height-c.close*scale;
let highY=canvas.height-c.high*scale;
let lowY=canvas.height-c.low*scale;

let color=c.close>c.open?"#00c389":"#ff3b3b";
ctx.strokeStyle=color;
ctx.fillStyle=color;

ctx.beginPath();
ctx.moveTo(x+candleWidth/2,highY);
ctx.lineTo(x+candleWidth/2,lowY);
ctx.stroke();

ctx.fillRect(x,Math.min(openY,closeY),candleWidth,Math.abs(openY-closeY));
x+=candleWidth+gap;
});
}

function animateChart(){
offset+=0.3;   // slow movement

if(offset>14){
offset=0;
let last=candles[candles.length-1].close;
candles.push(generateCandle(last));
candles.shift();
}

drawChart();
requestAnimationFrame(animateChart);
}

initChart();
animateChart();

function changePair(){
let pair=pairSelect.value;
livePair.textContent=pair;
localStorage.pair=pair;
basePrice=3000+Math.random()*40000;
initChart();
}
if(localStorage.pair){
pairSelect.value=localStorage.pair;
livePair.textContent=localStorage.pair;
}

/* ===============================
   UPDATED TRADE ENGINE
   +130 EVERY 5 MINUTES FOREVER
================================= */

const START=500;
const TARGET_GAIN=130;
const DURATION=5*60*1000;

let tradeActive=localStorage.tradeActive==="true";
let holdActive=localStorage.holdActive==="true";
let profitValue=Number(localStorage.profitValue||0);
let balance=Number(localStorage.balance||START);
let cycleStart=Number(localStorage.cycleStart||0);
let lockedCycles=Number(localStorage.lockedCycles||0);

let profitLoop;

function saveState(){
localStorage.tradeActive=tradeActive;
localStorage.holdActive=holdActive;
localStorage.profitValue=profitValue;
localStorage.balance=balance;
localStorage.cycleStart=cycleStart;
localStorage.lockedCycles=lockedCycles;
}

function setBalance(v){
balance=v;
totalBalance.textContent=balance.toFixed(2);
liveBalance.textContent="Balance: $"+balance.toFixed(2);
saveState();
}

function runProfit(){
if(!tradeActive||holdActive) return;

let change=(Math.random()-0.5)*15;
profitValue+=change;

profit.textContent=(profitValue>=0?"+$":"-$")+Math.abs(profitValue).toFixed(2);

let elapsed=Date.now()-cycleStart;
let cycles=Math.floor(elapsed/DURATION);

if(cycles>lockedCycles){
lockedCycles=cycles;
balance+=TARGET_GAIN;
}

setBalance(balance+profitValue);

profitLoop=setTimeout(runProfit,2000);
}

function toggleTrade(){
tradeActive=!tradeActive;
holdActive=false;

if(tradeActive){
cycleStart=cycleStart||Date.now();
tradeBtn.className="btn cancel";
tradeBtn.textContent="Cancel Trade";
runProfit();
}else{
tradeBtn.className="btn start";
tradeBtn.textContent="Start Trade";
clearTimeout(profitLoop);
}

saveState();
}

function toggleHold(){
if(!tradeActive) return;
holdActive=!holdActive;
holdBtn.textContent=holdActive?"Continue Trade":"Hold Trade";
if(!holdActive) runProfit();
saveState();
}

profit.textContent=(profitValue>=0?"+$":"-$")+Math.abs(profitValue).toFixed(2);
setBalance(balance);

if(tradeActive){
tradeBtn.className="btn cancel";
tradeBtn.textContent="Cancel Trade";
if(!holdActive) runProfit();
}
if(holdActive) holdBtn.textContent="Continue Trade";

</script>
</body>
</html>
